---
layout: 'layouts/default.njk'
title: 'Events'
eleventyNavigation:
  key: 'Events'
  sub: 'Guide'
  img: '/_assets/img/walkthrough/events.png'
  parent: Walkthrough
  order: 2
permalink: 'walkthrough/events/'
---

{%- from 'components/alert.njk' import alert %}
{%- from 'components/list-ol.njk' import list %}

<h2 class="heading mb-6">Event Order</h2>

{{ alert(label='Story Arcs',sub='The preceding icon designates a story arc. Some story arcs must be completed in order to trigger the final end game quest.',ico='mdi:pound') }}

{%- set navEvents %}
[
  {%- for item in collections.events %}
  { 
    title: {{ item.data.title | dump | safe }},
    url: {{ item.url | dump | safe }},
    story_arc: {{ item.data.story_arc | default('') | dump | safe }},
  },
  {%- endfor %}
]
{%- endset %}

<div 
  x-data="{
    query: '',
    navEvents: {{ navEvents }},

    decodeHtml(html) {
      const txt = document.createElement('textarea');
      txt.innerHTML = html;
      return txt.value;
    },

    slugify(str) {
      if (!str) return '';
      const decoded = this.decodeHtml(str.toString());
      return decoded
        .normalize('NFKD')
        .toLowerCase()
        .trim()
        .replace(/[^\w\s]/g, '') // remove apostrophes & other punctuation
        .replace(/\s+/g, ' ')
        .trim();
    },

    get filteredEvents() {
      if (!this.query.trim()) return this.navEvents;
      const q = this.slugify(this.query);
      return this.navEvents.filter(item => {
        const title = this.slugify(item.title);
        const arc = this.slugify(item.story_arc);
        return title.includes(q) || arc.includes(q);
      });
    },
  }"
  @keydown.window.prevent.meta.k="$refs.eventsSearch.focus()"
  class="prose"
>

  <div class="flex items-center justify-center gap-2 [&::before,&::after]:(h-px border-(t gray-600/25 dashed) grow hidden content-[''] sm:block)">
    <label class="group px-2 w-full max-w-[13.75rem] h-9 border-(& pri-50/25) bg-pri-50/20 text-sm inline-flex items-center gap-1 rounded-full outline-(& 2 transparent offset-1) shadow focus-within:(outline-current)">
      <span class="text-(pri-600 2xl) pointer-events-none select-none shrink-0 transition group-focus-within:text-current" aria-label="Search"><iconify-icon icon="mdi:magnify" class="iconify block" noobserver></iconify-icon></span>
      <input
        x-model="query"
        x-ref="eventsSearch"
        @keydown.escape.stop="query=''; $el.blur()"
        type="search"
        placeholder="Search event/arc"
        class="peer p-0 border-0 w-full bg-transparent grow placeholder:(text-pri-600 italic) focus:outline-none [&::-webkit-search-cancel-button]:(ml-2 w-3 h-6 appearance-none bg-(close center no-repeat) block cursor-pointer) transition"
      />
      <span class="text-(pri-600 xs) pointer-events-none select-none shrink-0 hidden group-focus-within:hidden peer-placeholder-shown:block">âŒ˜K</span>
    </label>
  </div>
  <div class="mt-6">


    <div x-show="query.trim() && filteredEvents.length === 0" class="text-center py-8 px-4 bg-pri-800/10 rounded shadow">
      <p>
        <strong>No events match your search.</strong>
        <small class="mt-1 text-xs block">Try different keywords or clear the search.</small>
      </p>
    </div>

    <ol x-show="filteredEvents.length > 0" :class="query.length && 'list-circle'" class="divide-(y gray-600/25 dashed)">
      <template x-for="item in filteredEvents" :key="item.url" hidden>
        <li class="m-0 py-1">
          <div class="p-2 flex items-center justify-between gap-3 relative">
            <a 
              :href="item.url" 
              class="font-medium no-underline before:(absolute inset-0 rounded transition) hover:(text-gray-900 underline underline-offset-2 before:bg-gray-600/10)"
              x-text="item.title"
            ></a>
            <template x-if="item.story_arc" hidden>
              <small class="flex items-center gap-1 text-gray-600 text-sm whitespace-nowrap shrink-0">
                <iconify-icon icon="mdi:pound" class="iconify opacity-60" noobserver></iconify-icon>
                <span x-text="item.story_arc"></span>
              </small>
            </template>
          </div>
        </li>
      </template>
    </ol>

  </div>

</div>
